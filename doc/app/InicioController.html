<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8">

<title>class InicioController - Rails Application Documentation</title>

<link href="./fonts.css" rel="stylesheet">
<link href="./rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script src="./js/jquery.js"></script>
<script src="./js/navigation.js"></script>
<script src="./js/search_index.js"></script>
<script src="./js/search.js"></script>
<script src="./js/searcher.js"></script>
<script src="./js/darkfish.js"></script>


<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link"><a href="ApplicationController.html">ApplicationController</a>
  
</div>

    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-i-admin">#admin</a>
    
    <li ><a href="#method-i-g_decision_maps">#g_decision_maps</a>
    
    <li ><a href="#method-i-g_goal_escenarios">#g_goal_escenarios</a>
    
    <li ><a href="#method-i-g_home">#g_home</a>
    
    <li ><a href="#method-i-g_priorization_escenarios">#g_priorization_escenarios</a>
    
    <li ><a href="#method-i-g_risk_escenarios">#g_risk_escenarios</a>
    
    <li ><a href="#method-i-getFilterEmpresa">#getFilterEmpresa</a>
    
    <li ><a href="#method-i-inicio">#inicio</a>
    
    <li ><a href="#method-i-modulos">#modulos</a>
    
    <li ><a href="#method-i-session_config">#session_config</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-InicioController">
  <h1 id="class-InicioController" class="class">
    class InicioController
  </h1>

  <section class="description">
    
  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-admin" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">admin</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Menú de administración, para generar las aplicaciones cliente para cada
empresa:</p>
          
          

          
          <div class="method-source-code" id="admin-source">
            <pre><span class="ruby-comment"># File app/controllers/inicio_controller.rb, line 21</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">admin</span>
      <span class="ruby-ivar">@empresas</span> = <span class="ruby-constant">Enterprise</span>.<span class="ruby-identifier">all</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-g_decision_maps" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">g_decision_maps</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Genera la carpeta raiz de los mapas de decision y sus hojas de estilo, y
alli crea el archivo inicial: index</p>
          
          

          
          <div class="method-source-code" id="g_decision_maps-source">
            <pre><span class="ruby-comment"># File app/controllers/inicio_controller.rb, line 267</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">g_decision_maps</span>
      <span class="ruby-identifier">timeInit</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
  <span class="ruby-identifier">empresa</span> = <span class="ruby-constant">Enterprise</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:idEmp</span>].<span class="ruby-identifier">to_i</span>)
  <span class="ruby-identifier">log</span> = []
  <span class="ruby-identifier">mapIds</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:mapIds</span>].<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot;%&quot;</span>)[<span class="ruby-value">0</span>]
  <span class="ruby-identifier">archIds</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:mapIds</span>].<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot;%&quot;</span>)[<span class="ruby-value">1</span>]
  <span class="ruby-identifier">mapIds</span>.<span class="ruby-identifier">blank?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">mapIds</span> = [] <span class="ruby-operator">:</span> <span class="ruby-identifier">mapIds</span> = <span class="ruby-identifier">mapIds</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot;|&quot;</span>)
  <span class="ruby-identifier">archIds</span>.<span class="ruby-identifier">blank?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">archIds</span> = [] <span class="ruby-operator">:</span> <span class="ruby-identifier">archIds</span> = <span class="ruby-identifier">archIds</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot;|&quot;</span>)

  <span class="ruby-comment"># Ejecuta la generacion en el engine!: Comentar si el engine no esta activo</span>
  <span class="ruby-comment"># ::MAPAS::</span>
  <span class="ruby-identifier">log2</span> = <span class="ruby-identifier">view_context</span>.<span class="ruby-identifier">mapasGenerateMapsHTML</span>(<span class="ruby-identifier">empresa</span>, <span class="ruby-identifier">mapIds</span>, <span class="ruby-identifier">archIds</span>, <span class="ruby-identifier">log</span>)
  <span class="ruby-identifier">log</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">log2</span>)

      <span class="ruby-identifier">timeFin</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
  <span class="ruby-identifier">timeExpend</span> = (<span class="ruby-identifier">timeFin</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">timeInit</span>).<span class="ruby-identifier">to_f</span>
      <span class="ruby-identifier">log</span>.<span class="ruby-identifier">push</span>(<span class="ruby-string">&quot;Finaliza creación contenido mapas de decisión - Tiempo requerido: &quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">timeExpend</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; (segundos)&#39;</span>)

      <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
              <span class="ruby-identifier">format</span>.<span class="ruby-identifier">json</span> {<span class="ruby-identifier">render</span> <span class="ruby-identifier">json</span><span class="ruby-operator">:</span> <span class="ruby-identifier">log</span>}
  <span class="ruby-keyword">end</span>

<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-g_goal_escenarios" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">g_goal_escenarios</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Genera los archivos de los escenarios de evaluacion de objetivos:</p>
          
          

          
          <div class="method-source-code" id="g_goal_escenarios-source">
            <pre><span class="ruby-comment"># File app/controllers/inicio_controller.rb, line 320</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">g_goal_escenarios</span>
  <span class="ruby-identifier">timeInit</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
  <span class="ruby-identifier">empresa</span> = <span class="ruby-constant">Enterprise</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:idEmp</span>].<span class="ruby-identifier">to_i</span>)
  <span class="ruby-identifier">log</span> = []
  <span class="ruby-identifier">goalIds</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:goalIds</span>].<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot;|&quot;</span>)

  <span class="ruby-identifier">log</span>.<span class="ruby-identifier">push</span>(<span class="ruby-string">&quot;Creando contenido de los escenarios de evaluación de objetivos...&quot;</span>)

  <span class="ruby-comment"># ::ESCENARIOS:: Comentar si el engine no esta activo!</span>
  <span class="ruby-identifier">log2</span> = <span class="ruby-identifier">view_context</span>.<span class="ruby-identifier">escenariosGenerateGoalsHTML</span>(<span class="ruby-identifier">empresa</span>, <span class="ruby-identifier">goalIds</span>, <span class="ruby-identifier">log</span>)
  <span class="ruby-identifier">log</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">log2</span>)  
  
  <span class="ruby-identifier">timeFin</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
  <span class="ruby-identifier">timeExpend</span> = (<span class="ruby-identifier">timeFin</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">timeInit</span>).<span class="ruby-identifier">to_f</span>
  <span class="ruby-identifier">log</span>.<span class="ruby-identifier">push</span>(<span class="ruby-string">&quot;Finaliza creación contenido escenarios de evaluación de objetivos - Tiempo requerido: &quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">timeExpend</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; (segundos)&#39;</span>)

  <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">json</span> {<span class="ruby-identifier">render</span> <span class="ruby-identifier">json</span><span class="ruby-operator">:</span> <span class="ruby-identifier">log</span>}
  <span class="ruby-keyword">end</span>


<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-g_home" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">g_home</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Genera la carpeta raiz de la empresa y las carpetas de imagenes y hojas de
estilo, y alli crea el archivo inicial: index</p>
          
          

          
          <div class="method-source-code" id="g_home-source">
            <pre><span class="ruby-comment"># File app/controllers/inicio_controller.rb, line 64</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">g_home</span>
      <span class="ruby-identifier">timeInit</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
      <span class="ruby-identifier">empresa</span> = <span class="ruby-constant">Enterprise</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:idEmp</span>].<span class="ruby-identifier">to_i</span>)
      <span class="ruby-identifier">log</span> = []


      <span class="ruby-comment"># Directorio actual:</span>
      <span class="ruby-identifier">actualFolder</span> = <span class="ruby-constant">Rails</span>.<span class="ruby-identifier">root</span>.<span class="ruby-identifier">to_s</span>
      <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span>(<span class="ruby-identifier">actualFolder</span>)

      <span class="ruby-comment"># Ruta archivo de estilos:</span>
      <span class="ruby-identifier">stylesRoute</span> = <span class="ruby-identifier">actualFolder</span><span class="ruby-operator">+</span><span class="ruby-string">&#39;/app/assets/stylesheets/metro-bootstrap.css&#39;</span>
  <span class="ruby-identifier">stylesJqRoute</span> = <span class="ruby-identifier">actualFolder</span><span class="ruby-operator">+</span><span class="ruby-string">&#39;/app/assets/stylesheets/my_jquery.css&#39;</span>
  <span class="ruby-identifier">imagesJqRoute</span> = <span class="ruby-identifier">actualFolder</span><span class="ruby-operator">+</span><span class="ruby-string">&#39;/app/assets/stylesheets/images&#39;</span>
      <span class="ruby-comment"># Ruta de la imagen de las jerarquias:</span>
      <span class="ruby-identifier">rightRoute</span> = <span class="ruby-identifier">actualFolder</span><span class="ruby-operator">+</span><span class="ruby-string">&#39;/app/assets/images/right.png&#39;</span>
      <span class="ruby-comment"># Rutas de las imagenes para la pantalla inicial:</span>
      <span class="ruby-identifier">mapRoute</span> = <span class="ruby-identifier">actualFolder</span><span class="ruby-operator">+</span><span class="ruby-string">&#39;/app/assets/images/map_b.png&#39;</span>
      <span class="ruby-identifier">riskRoute</span> = <span class="ruby-identifier">actualFolder</span><span class="ruby-operator">+</span><span class="ruby-string">&#39;/app/assets/images/risk_b.png&#39;</span>
      <span class="ruby-identifier">sortRoute</span> = <span class="ruby-identifier">actualFolder</span><span class="ruby-operator">+</span><span class="ruby-string">&#39;/app/assets/images/sort_b.png&#39;</span>
  <span class="ruby-identifier">goalRoute</span> = <span class="ruby-identifier">actualFolder</span><span class="ruby-operator">+</span><span class="ruby-string">&#39;/app/assets/images/goal_b.png&#39;</span>
  <span class="ruby-comment"># Rutas de las imagenes de uniandes y pacific</span>
  <span class="ruby-comment">#uniandesRoute = actualFolder+&#39;/app/assets/images/uniandes.png&#39;</span>
  <span class="ruby-comment">#pacificRoute = actualFolder+&#39;/app/assets/images/pacific.jpg&#39;</span>
  <span class="ruby-comment"># Rutas para las imagenes del dialogo de niveles de evaluacion de riesgos:</span>
  <span class="ruby-identifier">xAxisRoute</span> = <span class="ruby-identifier">actualFolder</span><span class="ruby-operator">+</span><span class="ruby-string">&#39;/app/assets/images/x-axis.png&#39;</span>
  <span class="ruby-identifier">yAxisRoute</span> = <span class="ruby-identifier">actualFolder</span><span class="ruby-operator">+</span><span class="ruby-string">&#39;/app/assets/images/y-axis.png&#39;</span>
  <span class="ruby-identifier">moneyRoute</span> = <span class="ruby-identifier">actualFolder</span><span class="ruby-operator">+</span><span class="ruby-string">&#39;/app/assets/images/money.png&#39;</span>
  <span class="ruby-identifier">impTolRoute</span> = <span class="ruby-identifier">actualFolder</span><span class="ruby-operator">+</span><span class="ruby-string">&#39;/app/assets/images/imp_tol.png&#39;</span>


      <span class="ruby-comment"># Crea la carpeta que contendrá los contenidos HTML:</span>
      <span class="ruby-identifier">rootFolder</span> = <span class="ruby-string">&#39;HTML_CONTENT&#39;</span>
      <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span>(<span class="ruby-identifier">rootFolder</span>)
      <span class="ruby-identifier">log</span>.<span class="ruby-identifier">push</span>(<span class="ruby-string">&quot;Creando contenido de la página inicial...&quot;</span>)
      <span class="ruby-identifier">log</span>.<span class="ruby-identifier">push</span>(<span class="ruby-string">&quot;Directorio creado: &quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">rootFolder</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;(Directorio principal)&#39;</span>)

      <span class="ruby-comment"># Actualiza el directorio actual: /HTML_CONTENT</span>
      <span class="ruby-identifier">actualFolder</span><span class="ruby-operator">+=</span> <span class="ruby-string">&#39;/&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">rootFolder</span>
      <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span>(<span class="ruby-identifier">actualFolder</span>)

      <span class="ruby-comment"># Crea la carpeta, cuyo nombre será [ID_Empresa] Nombre</span>
      <span class="ruby-identifier">folderName</span> = <span class="ruby-string">&#39;[&#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">empresa</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;] &#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">empresa</span>.<span class="ruby-identifier">name</span>
      <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span>(<span class="ruby-identifier">folderName</span>)
      <span class="ruby-identifier">log</span>.<span class="ruby-identifier">push</span>(<span class="ruby-string">&quot;Directorio creado: &quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">folderName</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;(Directorio de la empresa)&#39;</span>)

      <span class="ruby-comment"># Actualiza el directorio actual: /HTML_CONTENT/[ID_Empresa] Nombre</span>
      <span class="ruby-identifier">actualFolder</span><span class="ruby-operator">+=</span> <span class="ruby-string">&#39;/&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">folderName</span>
      <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span>(<span class="ruby-identifier">actualFolder</span>)
      <span class="ruby-identifier">rootEmpresa</span> = <span class="ruby-identifier">actualFolder</span>

      <span class="ruby-comment"># Crea la carpeta y el archivo de estilos:</span>
      <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span>(<span class="ruby-string">&#39;css&#39;</span>)
      <span class="ruby-identifier">log</span>.<span class="ruby-identifier">push</span>(<span class="ruby-string">&quot;Directorio creado: css (Para archivos .css)&quot;</span> )
      <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span>(<span class="ruby-identifier">actualFolder</span><span class="ruby-operator">+</span><span class="ruby-string">&quot;/css&quot;</span>)
      <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">cp</span> <span class="ruby-identifier">stylesRoute</span>, <span class="ruby-string">&#39;styles.css&#39;</span>
      <span class="ruby-comment">#log.push(&quot;Archivo de estilos copiado: styles.css (Archivo de estilos general)&quot;)</span>

  <span class="ruby-comment"># Adentro copia el archivo de estilos de jquery, y su carpeta propia de imagenes:</span>
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">cp</span> <span class="ruby-identifier">stylesJqRoute</span>, <span class="ruby-string">&#39;my_jquery.css&#39;</span>
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span>(<span class="ruby-string">&#39;images&#39;</span>)
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">cp_r</span>(<span class="ruby-constant">Dir</span>.<span class="ruby-identifier">glob</span>(<span class="ruby-identifier">imagesJqRoute</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;/*&#39;</span>), <span class="ruby-string">&#39;images&#39;</span>)

      <span class="ruby-comment"># Crea la carpeta de archivos .js:</span>
      <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span>(<span class="ruby-identifier">actualFolder</span>)
      <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span>(<span class="ruby-string">&#39;js&#39;</span>)
      <span class="ruby-identifier">log</span>.<span class="ruby-identifier">push</span>(<span class="ruby-string">&quot;Directorio creado: js (Para archivos JavaScript)&quot;</span>)

      <span class="ruby-comment"># Crea la carpeta de imagenes, y carga la imagen para las jerarquias en los mapas</span>
      <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span>(<span class="ruby-identifier">actualFolder</span>)
      <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span>(<span class="ruby-string">&#39;images&#39;</span>)
      <span class="ruby-identifier">log</span>.<span class="ruby-identifier">push</span>(<span class="ruby-string">&quot;Directorio creado: images (Para archivos .png)&quot;</span>)
      <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span>(<span class="ruby-identifier">actualFolder</span><span class="ruby-operator">+</span><span class="ruby-string">&quot;/images&quot;</span>)
      <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">cp</span> <span class="ruby-identifier">rightRoute</span>, <span class="ruby-string">&#39;right.png&#39;</span>
      <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">cp</span> <span class="ruby-identifier">mapRoute</span>, <span class="ruby-string">&#39;map_b.png&#39;</span>
      <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">cp</span> <span class="ruby-identifier">riskRoute</span>, <span class="ruby-string">&#39;risk_b.png&#39;</span>
      <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">cp</span> <span class="ruby-identifier">sortRoute</span>, <span class="ruby-string">&#39;sort_b.png&#39;</span>
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">cp</span> <span class="ruby-identifier">goalRoute</span>, <span class="ruby-string">&#39;goal_b.png&#39;</span>
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">cp</span> <span class="ruby-identifier">xAxisRoute</span>, <span class="ruby-string">&#39;x-axis.png&#39;</span>
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">cp</span> <span class="ruby-identifier">yAxisRoute</span>, <span class="ruby-string">&#39;y-axis.png&#39;</span>
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">cp</span> <span class="ruby-identifier">moneyRoute</span>, <span class="ruby-string">&#39;money.png&#39;</span>
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">cp</span> <span class="ruby-identifier">impTolRoute</span>, <span class="ruby-string">&#39;imp_tol.png&#39;</span>

  <span class="ruby-comment">#FileUtils.cp uniandesRoute, &#39;uniandes.png&#39;</span>
  <span class="ruby-comment"># Define la ruta del logo si es necesario:</span>
  <span class="ruby-identifier">addLogo</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:logo</span>]
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">addLogo</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;SI&#39;</span>
    <span class="ruby-identifier">logoRoute</span> = <span class="ruby-constant">Rails</span>.<span class="ruby-identifier">root</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;/public/system/logos/&#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">empresa</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;/&#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">empresa</span>.<span class="ruby-identifier">logo_file_name</span>
    <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">cp</span> <span class="ruby-identifier">logoRoute</span>, <span class="ruby-identifier">empresa</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;_&#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">empresa</span>.<span class="ruby-identifier">logo_file_name</span>
  <span class="ruby-keyword">end</span>


  <span class="ruby-comment">#FileUtils.cp pacificRoute, &#39;pacific.jpg&#39;</span>
      <span class="ruby-comment">#log.push(&quot;Imagen copiada: right.png (Para las jerarquías)&quot;)</span>

  <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span>(<span class="ruby-identifier">actualFolder</span>)
      <span class="ruby-comment"># Crea el archivo index:</span>
      <span class="ruby-identifier">fileHtml</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;index.html&quot;</span>, <span class="ruby-string">&quot;w&quot;</span>)
      <span class="ruby-identifier">lineHtml</span> = <span class="ruby-string">&#39;&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;
  &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./css/styles.css&quot;/&gt;&lt;/head&gt;&#39;</span>
      <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">lineHtml</span>
      <span class="ruby-identifier">lineHtml</span> = <span class="ruby-string">&#39;&lt;body&gt;&#39;</span>
      <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">lineHtml</span>
      <span class="ruby-identifier">lineHtml</span> = <span class="ruby-string">&#39;&lt;div style=&quot;width:100%;height:400px;&quot;&gt;&#39;</span>
  <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">lineHtml</span>
  <span class="ruby-identifier">lineHtml</span> = <span class="ruby-string">&#39;&lt;div style=&quot;text-align:center;margin:40px 0px 40px 0px;&quot;&gt;&#39;</span>
  <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">lineHtml</span>
  <span class="ruby-identifier">lineHtml</span> = <span class="ruby-string">&#39;&lt;h2 style=&quot;font-size:60px;&quot;&gt;Modelo de Gobierno de TI&lt;/h2&gt;&lt;/div&gt;&lt;div style=&quot;margin-bottom:35px;&quot;&gt;&#39;</span>
  <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">lineHtml</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">addLogo</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;SI&#39;</span>
    <span class="ruby-identifier">lineHtml</span> = <span class="ruby-string">&#39;&lt;center&gt;&lt;img style=&quot;max-width:260px;max-height:230px;&quot; src=&quot;./images/&#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">empresa</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;_&#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">empresa</span>.<span class="ruby-identifier">logo_file_name</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;&quot;&gt;&lt;/center&gt;&#39;</span>
    <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">lineHtml</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">lineHtml</span> = <span class="ruby-string">&#39;&lt;/div&gt;&lt;div class=&quot;containerHome&quot;&gt;&#39;</span>
      <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">lineHtml</span>
      <span class="ruby-identifier">lineHtml</span> = <span class="ruby-string">&#39;&lt;center&gt;&lt;img src=&quot;./images/map_b.png&quot; style=&quot;margin:40px 0 20px 0;&quot;&gt;&lt;/center&gt;&#39;</span>
      <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">lineHtml</span>
      <span class="ruby-comment">#lineHtml = &#39;&lt;a href=&quot;decisionMaps/indexMaps.html&quot;&gt;Mapas de Decisión&lt;/a&gt;&lt;/h4&gt;&lt;/div&gt;&lt;div class=&quot;containerHome&quot;&gt;&#39;</span>
  <span class="ruby-identifier">lineHtml</span> = <span class="ruby-string">&#39;&lt;h3 style=&quot;color:#333;font-size:22px;&quot;&gt;Mapas de Decisión&lt;/h3&gt;&#39;</span>
  <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">lineHtml</span>

  <span class="ruby-comment"># Renderiza el link de cada mapa:</span>
  <span class="ruby-comment">#mapas = empresa.decision_maps</span>
  <span class="ruby-identifier">mapIds</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:mapIds</span>].<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot;%&quot;</span>)[<span class="ruby-value">0</span>]
  <span class="ruby-identifier">mapIds</span>.<span class="ruby-identifier">blank?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">mapIds</span> = [] <span class="ruby-operator">:</span> <span class="ruby-identifier">mapIds</span> = <span class="ruby-identifier">mapIds</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot;|&quot;</span>)
  <span class="ruby-identifier">mapas</span> = <span class="ruby-constant">Mapas</span><span class="ruby-operator">::</span><span class="ruby-constant">DecisionMap</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-identifier">mapIds</span>)

  <span class="ruby-identifier">mapas</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">lineHtml</span> = <span class="ruby-string">&#39;&lt;a href=&quot;decisionMaps/map&#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">m</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;.html&quot;&gt;&#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">m</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;&lt;/a&gt;&lt;br&gt;&#39;</span>
    <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">lineHtml</span>
  <span class="ruby-keyword">end</span>


  <span class="ruby-identifier">lineHtml</span> = <span class="ruby-string">&#39;&lt;/div&gt;&lt;div class=&quot;containerHome&quot;&gt;&#39;</span>      
  <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">lineHtml</span>
      <span class="ruby-identifier">lineHtml</span> = <span class="ruby-string">&#39;&lt;center&gt;&lt;img src=&quot;./images/risk_b.png&quot; style=&quot;margin:40px 0 20px 0;&quot;&gt;&lt;/center&gt;&#39;</span>
      <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">lineHtml</span>
      <span class="ruby-comment">#lineHtml = &#39;&lt;a href=&quot;riskEscenarios/indexRiskEscenarios.html&quot;&gt;Escenarios de Evaluación de Riesgos&lt;/a&gt;&lt;/h4&gt;&lt;/div&gt;&#39;</span>
  <span class="ruby-identifier">lineHtml</span> = <span class="ruby-string">&#39;&lt;h3 style=&quot;color:#333;font-size:22px;&quot;&gt;Escenarios de Evaluación de Riesgos&lt;/h3&gt;&#39;</span>
      <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">lineHtml</span>

  <span class="ruby-comment"># Renderiza el link de cada mapa:</span>
  <span class="ruby-comment">#riskEsc = empresa.risk_escenarios</span>
  <span class="ruby-identifier">riskIds</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:riskIds</span>].<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot;|&quot;</span>)
  <span class="ruby-identifier">riskEsc</span> = <span class="ruby-constant">Escenarios</span><span class="ruby-operator">::</span><span class="ruby-constant">RiskEscenario</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-identifier">riskIds</span>)

  <span class="ruby-identifier">riskEsc</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">esc</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">lineHtml</span> = <span class="ruby-string">&#39;&lt;a href=&quot;riskEscenarios/esc&#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">esc</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;.html&quot;&gt;&#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">esc</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;&lt;/a&gt;&lt;br&gt;&#39;</span>
    <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">lineHtml</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">lineHtml</span> = <span class="ruby-string">&#39;&lt;/div&gt;&#39;</span>
  <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">lineHtml</span>

  <span class="ruby-comment"># Escenarios de evaluacion de objetivos:</span>
  <span class="ruby-identifier">lineHtml</span> = <span class="ruby-string">&#39;&lt;div class=&quot;containerHome&quot;&gt;&lt;center&gt;&lt;img src=&quot;./images/goal_b.png&quot; style=&quot;margin:40px 0 20px 0;&quot;&gt;&lt;/center&gt;&#39;</span>
  <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">lineHtml</span>
  <span class="ruby-identifier">lineHtml</span> = <span class="ruby-string">&#39;&lt;h3 style=&quot;color:#333;font-size:22px;&quot;&gt;Escenarios de Evaluación de Objetivos&lt;/h3&gt;&#39;</span>   
  <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">lineHtml</span>

  <span class="ruby-comment"># Renderiza el link de cada escenario:</span>
  <span class="ruby-comment">#goalEsc = empresa.goal_escenarios</span>
  <span class="ruby-identifier">goalIds</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:goalIds</span>].<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot;|&quot;</span>)
  <span class="ruby-identifier">goalEsc</span> = <span class="ruby-constant">Escenarios</span><span class="ruby-operator">::</span><span class="ruby-constant">GoalEscenario</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-identifier">goalIds</span>)


  <span class="ruby-identifier">goalEsc</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">esc</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">lineHtml</span> = <span class="ruby-string">&#39;&lt;a href=&quot;goalEscenarios/escG&#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">esc</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;.html&quot;&gt;&#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">esc</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;&lt;/a&gt;&lt;br&gt;&#39;</span>
    <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">lineHtml</span>
  <span class="ruby-keyword">end</span>

      <span class="ruby-identifier">lineHtml</span> = <span class="ruby-string">&#39;&lt;/div&gt;&lt;div class=&quot;containerHome&quot;&gt;&lt;center&gt;&lt;img src=&quot;./images/sort_b.png&quot; style=&quot;margin:40px 0 20px 0;&quot;&gt;&lt;/center&gt;&#39;</span>
      <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">lineHtml</span>
      <span class="ruby-comment">#lineHtml = &#39;&lt;h4 style=&quot;text-align:center;&quot;&gt;&lt;a href=&quot;priorizationEscenarios/indexPriorizationEscenarios.html&quot;&gt;Escenarios de Priorización&lt;/a&gt;&lt;/h4&gt;&#39;</span>
  <span class="ruby-identifier">lineHtml</span> = <span class="ruby-string">&#39;&lt;h3 style=&quot;color:#333;font-size:22px;&quot;&gt;Escenarios de Priorización&lt;/h3&gt;&#39;</span>         
  <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">lineHtml</span>

  <span class="ruby-comment"># Renderiza el link de cada mapa:</span>
  <span class="ruby-comment">#priorEsc = empresa.priorization_escenarios</span>
  <span class="ruby-identifier">priorIds</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:priorIds</span>].<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot;|&quot;</span>)
  <span class="ruby-identifier">priorEsc</span> = <span class="ruby-constant">Escenarios</span><span class="ruby-operator">::</span><span class="ruby-constant">PriorizationEscenario</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-identifier">priorIds</span>)

  <span class="ruby-identifier">priorEsc</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">esc</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">lineHtml</span> = <span class="ruby-string">&#39;&lt;a href=&quot;priorizationEscenarios/escP&#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">esc</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;.html&quot;&gt;&#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">esc</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;   [ &#39;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">esc</span>.<span class="ruby-identifier">fecha_ejecucion</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; ]&lt;/a&gt;&lt;br&gt;&#39;</span>
    <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">lineHtml</span>
  <span class="ruby-keyword">end</span>

      <span class="ruby-identifier">lineHtml</span> = <span class="ruby-string">&#39;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;&#39;</span>
      <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">lineHtml</span>
      <span class="ruby-identifier">fileHtml</span>.<span class="ruby-identifier">close</span>()
      <span class="ruby-identifier">timeFin</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
      <span class="ruby-identifier">timeExpend</span> = (<span class="ruby-identifier">timeFin</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">timeInit</span>).<span class="ruby-identifier">to_f</span>
      <span class="ruby-comment">#log.push(&quot;Archivo creado: index.html (Inicio)&quot;)</span>
      <span class="ruby-identifier">log</span>.<span class="ruby-identifier">push</span>(<span class="ruby-string">&quot;Finaliza creación contenido de la página inicial - Tiempo requerido: &quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">timeExpend</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; (segundos)&#39;</span>)

      <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
              <span class="ruby-identifier">format</span>.<span class="ruby-identifier">json</span> {<span class="ruby-identifier">render</span> <span class="ruby-identifier">json</span><span class="ruby-operator">:</span> <span class="ruby-identifier">log</span>}
    <span class="ruby-keyword">end</span>

<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-g_priorization_escenarios" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">g_priorization_escenarios</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <h6 id="method-i-g_priorization_escenarios-label-CIERRA+G_GOAL_ESCENARIOS">CIERRA G_GOAL_ESCENARIOS<span><a href="#method-i-g_priorization_escenarios-label-CIERRA+G_GOAL_ESCENARIOS">&para;</a> <a href="#documentation">&uarr;</a></span></h6>
          
          

          
          <div class="method-source-code" id="g_priorization_escenarios-source">
            <pre><span class="ruby-comment"># File app/controllers/inicio_controller.rb, line 345</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">g_priorization_escenarios</span>
      <span class="ruby-identifier">timeInit</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
      <span class="ruby-identifier">empresa</span> = <span class="ruby-constant">Enterprise</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:idEmp</span>].<span class="ruby-identifier">to_i</span>)
      <span class="ruby-identifier">log</span> = []
      <span class="ruby-comment">#escenarios = empresa.priorization_escenarios</span>
  <span class="ruby-identifier">priorIds</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:priorIds</span>].<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot;|&quot;</span>)

      <span class="ruby-identifier">log</span>.<span class="ruby-identifier">push</span>(<span class="ruby-string">&quot;Creando contenido de los escenarios de priorización...&quot;</span>)

  <span class="ruby-comment"># ::ESCENARIOS:: Comentar si el engine no esta activo!</span>
  <span class="ruby-identifier">log2</span> = <span class="ruby-identifier">view_context</span>.<span class="ruby-identifier">escenariosGeneratePriorsHTML</span>(<span class="ruby-identifier">empresa</span>, <span class="ruby-identifier">priorIds</span>, <span class="ruby-identifier">log</span>)
  <span class="ruby-identifier">log</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">log2</span>)

  <span class="ruby-identifier">timeFin</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
  <span class="ruby-identifier">timeExpend</span> = (<span class="ruby-identifier">timeFin</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">timeInit</span>).<span class="ruby-identifier">to_f</span>
  <span class="ruby-identifier">log</span>.<span class="ruby-identifier">push</span>(<span class="ruby-string">&quot;Finaliza creación contenido escenarios de priorización - Tiempo requerido: &quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">timeExpend</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; (segundos)&#39;</span>)

  <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">json</span> {<span class="ruby-identifier">render</span> <span class="ruby-identifier">json</span><span class="ruby-operator">:</span> <span class="ruby-identifier">log</span>}
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-g_risk_escenarios" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">g_risk_escenarios</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Genera la carpeta raiz de los escenarios de evaluación de riesgos y sus
hojas de estilo, y alli crea el archivo inicial: index</p>
          
          

          
          <div class="method-source-code" id="g_risk_escenarios-source">
            <pre><span class="ruby-comment"># File app/controllers/inicio_controller.rb, line 295</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">g_risk_escenarios</span>
      <span class="ruby-identifier">timeInit</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
      <span class="ruby-identifier">empresa</span> = <span class="ruby-constant">Enterprise</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:idEmp</span>].<span class="ruby-identifier">to_i</span>)
      <span class="ruby-identifier">log</span> = []
      <span class="ruby-comment">#escenarios = empresa.risk_escenarios</span>
  <span class="ruby-identifier">riskIds</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:riskIds</span>].<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot;|&quot;</span>)

      <span class="ruby-identifier">log</span>.<span class="ruby-identifier">push</span>(<span class="ruby-string">&quot;Creando contenido de los escenarios de evaluación de riesgos...&quot;</span>)

  <span class="ruby-comment"># ::ESCENARIOS:: Comentar si el engine no esta activo!</span>
  <span class="ruby-identifier">log2</span> = <span class="ruby-identifier">view_context</span>.<span class="ruby-identifier">escenariosGenerateRisksHTML</span>(<span class="ruby-identifier">empresa</span>, <span class="ruby-identifier">riskIds</span>,<span class="ruby-identifier">log</span>)
  <span class="ruby-identifier">log</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">log2</span>)    

  <span class="ruby-identifier">timeFin</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
  <span class="ruby-identifier">timeExpend</span> = (<span class="ruby-identifier">timeFin</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">timeInit</span>).<span class="ruby-identifier">to_f</span>
  <span class="ruby-identifier">log</span>.<span class="ruby-identifier">push</span>(<span class="ruby-string">&quot;Finaliza creación contenido escenarios de evaluación de riesgos - Tiempo requerido: &quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">timeExpend</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39; (segundos)&#39;</span>)

      <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
              <span class="ruby-identifier">format</span>.<span class="ruby-identifier">json</span> {<span class="ruby-identifier">render</span> <span class="ruby-identifier">json</span><span class="ruby-operator">:</span> <span class="ruby-identifier">log</span>}
  <span class="ruby-keyword">end</span>

<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-getFilterEmpresa" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getFilterEmpresa</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Todo el contenido seleccionable para generar el HTML:</p>
          
          

          
          <div class="method-source-code" id="getFilterEmpresa-source">
            <pre><span class="ruby-comment"># File app/controllers/inicio_controller.rb, line 26</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">getFilterEmpresa</span>
  <span class="ruby-identifier">empresa</span> = <span class="ruby-constant">Enterprise</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:idEmp</span>].<span class="ruby-identifier">to_i</span>)
  <span class="ruby-identifier">content</span> = []
  <span class="ruby-comment"># El primer registro valida si la empresa tiene logo o no:</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">empresa</span>.<span class="ruby-identifier">logo</span>.<span class="ruby-identifier">blank?</span>
    <span class="ruby-identifier">content</span>[<span class="ruby-value">0</span>] = <span class="ruby-string">&#39;NO_LOGO&#39;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">content</span>[<span class="ruby-value">0</span>] = <span class="ruby-string">&#39;SI_LOGO&#39;</span>
  <span class="ruby-keyword">end</span>


  <span class="ruby-comment"># Mapas de decision:</span>
  <span class="ruby-identifier">mapasFormateados</span> = <span class="ruby-identifier">view_context</span>.<span class="ruby-identifier">mapasListDecisionMaps</span>(<span class="ruby-identifier">empresa</span>.<span class="ruby-identifier">id</span>)
  <span class="ruby-comment"># Agrega los mapas formateados:</span>
  <span class="ruby-identifier">content</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">mapasFormateados</span>)

  <span class="ruby-comment"># Escenarios de Evaluacion de Riesgos:</span>
  <span class="ruby-identifier">riesgosFormateados</span> = <span class="ruby-identifier">view_context</span>.<span class="ruby-identifier">escenariosListRiskEscenarios</span>(<span class="ruby-identifier">empresa</span>.<span class="ruby-identifier">id</span>)
  <span class="ruby-comment"># Agrega los mapas formateados:</span>
  <span class="ruby-identifier">content</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">riesgosFormateados</span>)

  <span class="ruby-comment"># Escenarios de Evaluacion de Objetivos:</span>
  <span class="ruby-identifier">goalsFormateados</span> = <span class="ruby-identifier">view_context</span>.<span class="ruby-identifier">escenariosListGoalEscenarios</span>(<span class="ruby-identifier">empresa</span>.<span class="ruby-identifier">id</span>)
  <span class="ruby-comment"># Agrega los mapas formateados:</span>
  <span class="ruby-identifier">content</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">goalsFormateados</span>)

  <span class="ruby-comment"># Escenarios de Priorizacion:</span>
  <span class="ruby-identifier">priorsFormateados</span> = <span class="ruby-identifier">view_context</span>.<span class="ruby-identifier">escenariosListPriorEscenarios</span>(<span class="ruby-identifier">empresa</span>.<span class="ruby-identifier">id</span>)
  <span class="ruby-comment"># Agrega los mapas formateados:</span>
  <span class="ruby-identifier">content</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">priorsFormateados</span>)

  <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">json</span> {<span class="ruby-identifier">render</span> <span class="ruby-identifier">json</span><span class="ruby-operator">:</span> <span class="ruby-identifier">content</span>}
  <span class="ruby-keyword">end</span>

<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-inicio" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">inicio</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="inicio-source">
            <pre><span class="ruby-comment"># File app/controllers/inicio_controller.rb, line 6</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">inicio</span>
  <span class="ruby-comment"># Las empresas se cargan según los roles del usuario: Si es evaluador, sólo carga su empresa, si es administrador, carga todas</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">has_role?</span> <span class="ruby-constant">ROLE_ADMIN</span>
    <span class="ruby-ivar">@empresas</span> = <span class="ruby-constant">Enterprise</span>.<span class="ruby-identifier">all</span>  
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">has_role?</span> <span class="ruby-constant">ROLE_EVAL</span>
    <span class="ruby-ivar">@empresas</span> = <span class="ruby-constant">Enterprise</span>.<span class="ruby-identifier">all</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@empresas</span> = []
    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">enterprise</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-ivar">@empresas</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">enterprise</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>         
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-modulos" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">modulos</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>——- <a
href="InicioController.html#method-i-g_priorization_escenarios">#g_priorization_escenarios</a></p>
          
          

          
          <div class="method-source-code" id="modulos-source">
            <pre><span class="ruby-comment"># File app/controllers/inicio_controller.rb, line 368</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">modulos</span>
  <span class="ruby-identifier">accesos</span> = [<span class="ruby-keyword">false</span>, <span class="ruby-keyword">false</span>, <span class="ruby-keyword">false</span>, <span class="ruby-keyword">false</span>]

  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-comment"># Está logueado</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">has_role?</span> <span class="ruby-constant">ROLE_ADMIN</span>
      <span class="ruby-identifier">accesos</span> = [<span class="ruby-keyword">true</span>, <span class="ruby-keyword">true</span>, <span class="ruby-keyword">true</span>, <span class="ruby-keyword">true</span>]
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">has_role?</span> <span class="ruby-constant">ROLE_EVAL</span>
      <span class="ruby-identifier">accesos</span> = [<span class="ruby-keyword">true</span>, <span class="ruby-keyword">true</span>, <span class="ruby-keyword">true</span>, <span class="ruby-keyword">true</span>]
    <span class="ruby-keyword">else</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">has_role?</span> <span class="ruby-constant">ROLE_USER_CONFIG</span>
      <span class="ruby-identifier">accesos</span>[<span class="ruby-value">0</span>] = <span class="ruby-keyword">true</span>
                <span class="ruby-keyword">end</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">has_role?</span> <span class="ruby-constant">ROLE_USER_GOV</span>
                        <span class="ruby-identifier">accesos</span>[<span class="ruby-value">1</span>] = <span class="ruby-keyword">true</span>
                <span class="ruby-keyword">end</span> 
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">has_role?</span> <span class="ruby-constant">ROLE_USER_SIMULATION</span>
                        <span class="ruby-identifier">accesos</span>[<span class="ruby-value">2</span>] = <span class="ruby-keyword">true</span>
                <span class="ruby-keyword">end</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">has_role?</span> <span class="ruby-constant">ROLE_USER_QUANTIFY</span>
                        <span class="ruby-identifier">accesos</span>[<span class="ruby-value">3</span>] = <span class="ruby-keyword">true</span>
                <span class="ruby-keyword">end</span> 
        <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">json</span> {<span class="ruby-identifier">render</span> <span class="ruby-identifier">json</span><span class="ruby-operator">:</span> <span class="ruby-identifier">accesos</span>}
  <span class="ruby-keyword">end</span>

<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-session_config" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">session_config</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Configura la sesion con el valor de la empresa seleccionada:</p>
          
          

          
          <div class="method-source-code" id="session_config-source">
            <pre><span class="ruby-comment"># File app/controllers/inicio_controller.rb, line 401</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">session_config</span>
  <span class="ruby-comment"># Antes de crear la sesion, verifica que el usuario pueda tener acceso a esa empresa:</span>
  <span class="ruby-identifier">autorizado</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">enterprise</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-comment"># Está limitado a una sola empresa, verifica que sea esa la que llego como parametro:</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:idEmpresa</span>].<span class="ruby-identifier">to_i</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">enterprise</span>.<span class="ruby-identifier">id</span>
      <span class="ruby-comment"># No tiene acceso</span>
      <span class="ruby-identifier">autorizado</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Crea la sesion, si el usuario está autorizado, si no, lo bloquea:</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">autorizado</span>
    <span class="ruby-identifier">user_session</span>[<span class="ruby-value">:empresa</span>] = <span class="ruby-identifier">params</span>[<span class="ruby-value">:idEmpresa</span>].<span class="ruby-identifier">to_i</span>;
    <span class="ruby-identifier">toRender</span> = <span class="ruby-string">&#39;OK&#39;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">toRender</span> = <span class="ruby-string">&#39;ERROR&#39;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">json</span> {<span class="ruby-identifier">render</span> <span class="ruby-identifier">text</span><span class="ruby-operator">:</span> <span class="ruby-identifier">toRender</span>}
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://rdoc.rubyforge.org">RDoc</a> 4.1.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

